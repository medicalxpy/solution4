/volume1/home/pxie/.local/lib/python3.9/site-packages/cupy/_environment.py:437: UserWarning: 
--------------------------------------------------------------------------------

  CuPy may not function correctly because multiple CuPy packages are installed
  in your environment:

    cupy-cuda101, cupy-cuda117

  Follow these steps to resolve this issue:

    1. For all packages listed above, run the following command to remove all
       existing CuPy installations:

         $ pip uninstall <package_name>

      If you previously installed CuPy via conda, also run the following:

         $ conda uninstall cupy

    2. Install the appropriate CuPy package.
       Refer to the Installation Guide for detailed instructions.

         https://docs.cupy.dev/en/stable/install.html

--------------------------------------------------------------------------------

  warnings.warn(f'''
AnnData中的基因数: 21432
基因嵌入中的基因数: 33622
共有基因数: 20493
Settings: 
                N Components: 50
                Topic Prior Mean: 0.0
                Topic Prior Variance: None
                Model Type: prodLDA
                Hidden Sizes: (100, 100)
                Activation: softplus
                Dropout: 0.2
                Learn Priors: True
                Learning Rate: 0.0001
                Momentum: 0.99
                Reduce On Plateau: False
                Save Dir: None
0it [00:00, ?it/s]epoch: 0 loss: 1935.1712491239768 best_loss: 1935.1712491239768
epoch: 1 loss: 1868.2533622470253 best_loss: 1868.2533622470253
epoch: 2 loss: 1848.1472721489697 best_loss: 1848.1472721489697
epoch: 3 loss: 1838.7762624897982 best_loss: 1838.7762624897982
epoch: 4 loss: 1826.760485941492 best_loss: 1826.760485941492
epoch: 5 loss: 1817.5120941092803 best_loss: 1817.5120941092803
epoch: 6 loss: 1813.244114750899 best_loss: 1813.244114750899
epoch: 7 loss: 1809.5560718568142 best_loss: 1809.5560718568142
epoch: 8 loss: 1807.2433525738077 best_loss: 1807.2433525738077
epoch: 9 loss: 1805.6804795247149 best_loss: 1805.6804795247149
epoch: 10 loss: 1804.879109823731 best_loss: 1804.879109823731
epoch: 11 loss: 1803.9950926995116 best_loss: 1803.9950926995116
epoch: 12 loss: 1802.9336642569253 best_loss: 1802.9336642569253
epoch: 13 loss: 1802.403613059472 best_loss: 1802.403613059472
epoch: 14 loss: 1802.1383950221186 best_loss: 1802.1383950221186
epoch: 15 loss: 1801.3484552052778 best_loss: 1801.3484552052778
epoch: 16 loss: 1800.609499934945 best_loss: 1800.609499934945
epoch: 17 loss: 1800.1850452870694 best_loss: 1800.1850452870694
epoch: 18 loss: 1799.8067597382724 best_loss: 1799.8067597382724
epoch: 19 loss: 1799.0600231092685 best_loss: 1799.0600231092685
epoch: 20 loss: 1799.075855841337 best_loss: 1799.0600231092685
epoch: 21 loss: 1798.006030144067 best_loss: 1798.006030144067
epoch: 22 loss: 1798.2500047127826 best_loss: 1798.006030144067
epoch: 23 loss: 1797.2703914714527 best_loss: 1797.2703914714527
epoch: 24 loss: 1797.4622742669499 best_loss: 1797.2703914714527
epoch: 25 loss: 1797.1000863825345 best_loss: 1797.1000863825345
epoch: 26 loss: 1797.2091626290749 best_loss: 1797.1000863825345
epoch: 27 loss: 1796.9053655677812 best_loss: 1796.9053655677812
epoch: 28 loss: 1796.205774045911 best_loss: 1796.205774045911
epoch: 29 loss: 1796.693957713587 best_loss: 1796.205774045911
epoch: 30 loss: 1796.1816122558964 best_loss: 1796.1816122558964
epoch: 31 loss: 1796.0414790486316 best_loss: 1796.0414790486316
epoch: 32 loss: 1795.5805743532953 best_loss: 1795.5805743532953
epoch: 33 loss: 1795.7149226660083 best_loss: 1795.5805743532953
epoch: 34 loss: 1795.8367480986233 best_loss: 1795.5805743532953
epoch: 35 loss: 1795.4052858201055 best_loss: 1795.4052858201055
epoch: 36 loss: 1795.4720544923352 best_loss: 1795.4052858201055
epoch: 37 loss: 1795.3667292511886 best_loss: 1795.3667292511886
epoch: 38 loss: 1795.2007541006753 best_loss: 1795.2007541006753
epoch: 39 loss: 1795.0116333654664 best_loss: 1795.0116333654664
epoch: 40 loss: 1794.6588594954994 best_loss: 1794.6588594954994
epoch: 41 loss: 1794.4007755946607 best_loss: 1794.4007755946607
epoch: 42 loss: 1793.7911051678711 best_loss: 1793.7911051678711
epoch: 43 loss: 1793.7125586972463 best_loss: 1793.7125586972463
epoch: 44 loss: 1793.7530585959678 best_loss: 1793.7125586972463
epoch: 45 loss: 1793.4529330696146 best_loss: 1793.4529330696146
epoch: 46 loss: 1793.501538215308 best_loss: 1793.4529330696146
epoch: 47 loss: 1793.7015092547963 best_loss: 1793.4529330696146
epoch: 48 loss: 1793.413126134764 best_loss: 1793.413126134764
epoch: 49 loss: 1792.9739543906132 best_loss: 1792.9739543906132
epoch: 50 loss: 1792.7432228336725 best_loss: 1792.7432228336725
epoch: 51 loss: 1793.4269501125154 best_loss: 1792.7432228336725
epoch: 52 loss: 1792.8926335695023 best_loss: 1792.7432228336725
epoch: 53 loss: 1792.7750743141146 best_loss: 1792.7432228336725
epoch: 54 loss: 1793.2278900261995 best_loss: 1792.7432228336725
epoch: 55 loss: 1792.2558169599558 best_loss: 1792.2558169599558
epoch: 56 loss: 1792.0995554090177 best_loss: 1792.0995554090177
epoch: 57 loss: 1792.2761882865727 best_loss: 1792.0995554090177
epoch: 58 loss: 1792.3063150733642 best_loss: 1792.0995554090177
epoch: 59 loss: 1792.2724530828623 best_loss: 1792.0995554090177
epoch: 60 loss: 1792.4827233082774 best_loss: 1792.0995554090177
epoch: 61 loss: 1791.7104445059674 best_loss: 1791.7104445059674
epoch: 62 loss: 1792.016552401708 best_loss: 1791.7104445059674
epoch: 63 loss: 1791.5356711446111 best_loss: 1791.5356711446111
epoch: 64 loss: 1791.1952599201304 best_loss: 1791.1952599201304
epoch: 65 loss: 1791.784273203894 best_loss: 1791.1952599201304
epoch: 66 loss: 1791.8487473978048 best_loss: 1791.1952599201304
epoch: 67 loss: 1791.498508727704 best_loss: 1791.1952599201304
epoch: 68 loss: 1791.6691867733075 best_loss: 1791.1952599201304
epoch: 69 loss: 1791.185939606891 best_loss: 1791.185939606891
epoch: 70 loss: 1791.5127922479714 best_loss: 1791.185939606891
epoch: 71 loss: 1791.1881742975552 best_loss: 1791.185939606891
epoch: 72 loss: 1791.3739266868436 best_loss: 1791.185939606891
epoch: 73 loss: 1791.166099808236 best_loss: 1791.166099808236
epoch: 74 loss: 1790.7884901279215 best_loss: 1790.7884901279215
epoch: 75 loss: 1790.858349461523 best_loss: 1790.7884901279215
epoch: 76 loss: 1791.2440922958756 best_loss: 1790.7884901279215
